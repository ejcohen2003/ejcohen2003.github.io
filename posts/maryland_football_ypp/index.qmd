---
title: "Maryland Ypp"
author: "Eli Cohen"
date: '2024-10-23'
format: 
  html:
    code-fold: true
---
```{r}
library(tidyverse)
install.packages("ggrepel")
library(ggrepel)
```
```{r}
ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="red") + 
  geom_vline(xintercept = 5.740424) + 
  geom_hline(yintercept = 5.609849) +
  geom_text_repel(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, label=Season)
  ) +
  labs(title="Balance keeps Maryland out of the Big Ten's basement", subtitle="The Terps offense has grabbed headlines, but the defense holds their own.")  + theme_minimal() + 
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.title = element_text(size = 8), 
    plot.subtitle = element_text(size=10), 
    panel.grid.minor = element_blank()
    )
```
Maryland football's Michael Locksley and Taulia Tagovailoa-led offense typically comes to mind when thinking about its rise from the bottom of the Big Ten â€” but their defense has been just as crucial since Locksley took the helm in 2019. 

The Terps' defense outperformed their offense in two of the last three years, a span where they won three consecutive bowl games for the first time in program history. Maryland's defense led the way in both 2022 and 2023, where it reached eight wins in consecutive seasons for the first time in over 20 years.



```{r}
logs=footballlogs1124_3_
```

```{r}
winlosslogs <- logs |> 
  mutate(
    wins = case_when(
      grepl("W", Outcome) ~ 1, 
      grepl("L", Outcome) ~ 0)
)
```

```{r}
winlosslogs |> 
  group_by(Team, Conference, Season) |> 
  summarise(
    TotalPlays = sum(OffensivePlays), 
    TotalYards = sum(OffensiveYards), 
    DefensivePlays = sum(DefPlays), 
    DefensiveYards = sum(DefYards), 
    TotalWins = sum(wins),
    TotalGames = n()) |>
  mutate(
    OffensiveYPP = TotalYards/TotalPlays, 
    DefensiveYPP = DefensiveYards/DefensivePlays,
    WinPct=TotalWins/TotalGames) -> ypp
```

Added total games and win percentage so the 2024 data would remain significant/not be skewed
```{r}
#ggplot() + 
  geom_point(
    data=ypp, aes(x=OffensiveYPP, y=DefensiveYPP)
    )
```

```{r}
#ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct)
    )
```
```{r}
#ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct),
    alpha = .3) + 
  scale_size(range = c(3, 8), name="Winning Percentage")
```
```{r}
maryland <- ypp |> filter(Team == "Maryland")
```
Filtered just to Maryland
```{r}
#ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct, 
    color="red"))
```

```{r}
ypp |> 
  ungroup() |> 
  summarise(
    offense = mean(OffensiveYPP), 
    defense = mean(DefensiveYPP)
    )
```

```{r}
#ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="red") + 
  geom_vline(xintercept = 5.740424) + 
  geom_hline(yintercept = 5.609849)
```
```{r}
#ggplot() + 
  geom_point(
    data=ypp, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="grey", 
    alpha=.5) + 
  geom_point(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, size=WinPct), 
    color="red") + 
  geom_vline(xintercept = 5.740424) + 
  geom_hline(yintercept = 5.609849) +
  geom_text_repel(
    data=maryland, 
    aes(x=OffensiveYPP, y=DefensiveYPP, label=Season)
  )
```

