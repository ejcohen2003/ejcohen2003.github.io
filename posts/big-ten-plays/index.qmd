```{r}
library(tidyverse)
```

```{title: "Big Ten average offensive plays"}
author: "Eli Cohen"
date: '2024-10-08'
format: 
  html:
    code-fold: true

```

Loading the data:

```{r}
data_23 <- read_csv("https://dwillis.github.io/sports-data-files/footballlogs23.csv")

```

```{r}
data_24 <- read_csv("https://dwillis.github.io/sports-data-files/footballlogs24.csv")
```

Clustering the Big Ten and creating new data sets that show the average offensive plays for every team in the conference.

```{r}
big10 <- c("Nebraska Cornhuskers", "Iowa Hawkeyes", "Minnesota Golden Gophers", "Illinois Fighting Illini", "Northwestern Wildcats", "Wisconsin Badgers", "Indiana Hoosiers", "Purdue Boilermakers", "Ohio State Buckeyes", "Michigan Wolverines", "Michigan State Spartans", "Penn State Nittany Lions", "Rutgers Scarlet Knights", "Maryland Terrapins")
```

```{r}
b1g_23 <- data_23 |>
  filter(TeamFull %in% big10) |>
  group_by(TeamFull) |>
   summarize(avg_plays=mean(OffensivePlays)) |>
  select(TeamFull, avg_plays)
```

```{r}
b1g_24 <- data_24 |>
  filter(TeamFull %in% big10) |>
  group_by(TeamFull) |>
  summarize(avg_plays=mean(OffensivePlays)) |>
  select(TeamFull, avg_plays)

```

Creating the graphs:

```{r}
ggplot() + 
  geom_bar(
    data=b1g_23, 
    aes(x=reorder(TeamFull, avg_plays), weight=avg_plays)
  ) +
  coord_flip()+
   labs(
    title="2023 Big Ten ofensive plays per game prior to rule change", 
    x="School", 
    y="Average Plays")
```

```{r}
ggplot() + 
  geom_bar(
    data=b1g_24, 
    aes(x=reorder(TeamFull, avg_plays), weight=avg_plays)
  ) +
  coord_flip()+
   labs(
    title="Average plays remained similar in 2024 despite rule change", 
    x="School", 
    y="Average Plays"
)
```

Maryland took a jump and has averaged the most offensive plays in the Big Ten so far this season — which I assume is in large part to the defense's ability to force turnovers — but the overall trend among the Big Ten teams from 2023 and 2024 (just looking at the ones who were in the conference last year) is just that the average plays has remained similar.\
\
Last year each team averaged somewhere between 60 plays and a number in the low 70s. While a flat-out atrocious Purdue team fell out of that range, all 13 others are still there.
